<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>집중 헤드헌팅</title>
<style>
body { font-family:sans-serif; text-align:center; padding:20px; background:#111; color:white; }
button { font-size:20px; padding:10px 20px; margin:10px; }

.infra { color:red; }
.ultra { color:violet; }
.lumen { color:silver; }

.pickupMark { font-weight:bold; }
</style>
</head>
<body>

<h2>[집중 헤드헌팅]</h2>

<button onclick="pull(1)">1회</button>
<button onclick="pull(10)">10회</button>

<div id="result"></div>

<script>

// ======================
// 캐릭터 DB
// weight 기본값은 1
// ======================

let DB = [
    {name:"발렌티나", rarity:3, weight:1},
    {name:"백연", rarity:3, weight:1},
    {name:"도로시", rarity:3, weight:1},
    {name:"마리", rarity:3, weight:1},
    {name:"로렌츠", rarity:3, weight:1},

    {name:"올가", rarity:2, weight:1},
    {name:"나모", rarity:2, weight:1},
    {name:"올리버", rarity:2, weight:1},
    {name:"유나", rarity:2, weight:1},
    {name:"암젤", rarity:2, weight:1},
    {name:"니콜라", rarity:2, weight:1},

    {name:"재클린", rarity:1, weight:1},
    {name:"할", rarity:1, weight:1},
    {name:"헤더스", rarity:1, weight:1},
    {name:"프리츠", rarity:1, weight:1},
    {name:"에밀리", rarity:1, weight:1},
    {name:"베르너", rarity:1, weight:1}
];

// ======================
// 현재 픽업 지정
// ======================

let PICKUP_3 = "발렌티아";
let PICKUP_2 = "아이리스";

// 픽업 가중치 설정
function applyPickupWeights(){
    DB.forEach(c => {
        c.weight = 1; // 초기화

        if(c.name === PICKUP_3){
            c.weight = 5; // 3성 픽업 가중치 증가
        }
        if(c.name === PICKUP_2){
            c.weight = 4; // 2성 픽업 가중치 증가
        }
    });
}

applyPickupWeights();

// ======================
// 희귀도 확률
// ======================

function rollRarity(){
    let r = Math.random();
    if(r < 0.03) return 3;
    if(r < 0.23) return 2;
    return 1;
}

// ======================
// 가중치 랜덤 선택
// ======================

function weightedRandom(pool){

    let totalWeight = pool.reduce((sum,c)=>sum+c.weight,0);
    let r = Math.random() * totalWeight;

    for(let c of pool){
        if(r < c.weight) return c;
        r -= c.weight;
    }
}

// ======================
// 색상 클래스
// ======================

function getClass(rarity){
    if(rarity === 3) return "lumen";
    if(rarity === 2) return "ultra";
    return "infra";
}

// ======================
// 뽑기
// ======================

function pull(times){

    let output = "";

    for(let i=0;i<times;i++){

        let rarity = rollRarity();
        let pool = DB.filter(c => c.rarity === rarity);
        let char = weightedRandom(pool);

        let isPickup = (char.name === PICKUP_3 || char.name === PICKUP_2);

        output += `<div class="${getClass(char.rarity)} ${isPickup ? 'pickupMark':''}">
        ★${char.rarity} ${char.name} ${isPickup ? '[PICK UP]' : ''}
        </div>`;
    }

    document.getElementById("result").innerHTML = output;
}

</script>

</body>
</html>
